<style type="text/css">
    body {
      background: #F2F2F2;
    }

    /* Profile container */
    .profile {
      margin: 20px 0;
    }

    /* Profile sidebar */
    .profile-sidebar {
      padding: 20px 0 10px 0;
      background: #fff;
    }

    .profile-userpic img {
      float: none;
      margin: 0 auto;
      width: 100px;
      height: 100px;
      background: gray;
      -webkit-border-radius: 50% !important;
      -moz-border-radius: 50% !important;
      border-radius: 50% !important;
    }

    .profile-usertitle {
      text-align: center;
      margin-top: 20px;
    }

    .profile-usertitle-name {
      color: #5a7391;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 7px;
    }

    .profile-usertitle-job {
      text-transform: uppercase;
      color: #5b9bd1;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .profile-userbuttons {
      text-align: center;
      margin-top: 10px;
    }

    .profile-userbuttons .btn {
      text-transform: uppercase;
      font-size: 11px;
      font-weight: 600;
      padding: 6px 15px;
      margin-right: 5px;
    }

    .profile-userbuttons .btn:last-child {
      margin-right: 0px;
    }
        
    .profile-usermenu {
      margin-top: 30px;
    }

    .profile-usermenu ul li {
      border-bottom: 1px solid #f0f4f7;
    }

    .profile-usermenu ul li:last-child {
      border-bottom: none;
    }

    .profile-usermenu ul li a {
      color: #93a3b5;
      font-size: 14px;
      font-weight: 400;
    }

    .profile-usermenu ul li a i {
      margin-right: 8px;
      font-size: 14px;
    }

    .profile-usermenu ul li a:hover {
      background-color: #fafcfd;
      color: #5b9bd1;
    }

    .profile-usermenu ul li.active {
      border-bottom: none;
    }

    .profile-usermenu ul li.active a {
      color: #5b9bd1;
      background-color: #f6f9fb;
      border-left: 2px solid #5b9bd1;
      margin-left: -2px;
    }

    /* Profile Content */
    .profile-content {
      padding: 20px;
      background: #fff;
      min-height: 460px;
    }

    button.btn.btn-primary-blue.btn-sm {
      color: #fff;
      background-color: #4183c4;
      border-color: #4183c4;
    }

    /* Adding the form for password forgot */
    .form-password-change {

      padding: 15px;
      margin: 0 auto;
    }

    input#gl-pass-1 {
      max-width: 300px;
    }

    input#gl-username-1 {
      max-width: 300px;
    }

    input#gl-job-1 {
      max-width: 300px;
    }

    input#gl-website-1 {
      max-width: 300px;
    }
    input#gl-email-1 {
      max-width: 300px;
    }
    #userimage{
      position: relative;
      opacity: 1;
      margin: 0 auto;
      font-size: 12px;
      display: none;
    }

    .saveBtn{
        width: 70%;
        margin: 10px auto;
    }
</style>
</head>
<body>
<%- partial ('../partials/topbar-without-menu.ejs') %>
<section id="gitlist-top-abstand"></section>
<div class="container">
    <div class="row profile">
        <div class="col-md-3">
            <div class="profile-sidebar">
                <!-- SIDEBAR USERPIC -->
                <div class="profile-userpic">
                    <form action="/uploadImage" name="multiform" id="multiform" method="post" enctype="multipart/form-data">
                        <% if(username != "") { %>
                            <img id="userpic" src="<%- picture%>" class="img-responsive" alt="">
                            <input type="file" id="userimage" name="uploadImage"/>                        
                            <button type="submit" class="saveBtn btn btn-lg btn-primary btn-block"  id="color-blue">Save Picture</button>
                        <% }else{ %>
                            <img id="userpic" src="/images/user-1.png" class="img-responsive" alt="">
                            <input type="file" id="userimage" name="uploadImage" disabled />
                            <button type="submit" class="saveBtn btn btn-lg btn-primary btn-block" id="color-blue" disabled>Save Picture</button>
                        <% } %>
                    </form>
                </div>
                <!-- END SIDEBAR USERPIC -->
                <!-- SIDEBAR USER TITLE -->
                <div class="profile-usertitle">
                    <% if(username != "") { %>
                        <div class="profile-usertitle-name"><%- username%></div>
                        <div class="profile-usertitle-job"><%- job%></div>
                    <% }else{ %>
                        <div class="profile-usertitle-name"></div>
                        <div class="profile-usertitle-job"></div>
                    <% } %>
                </div>
                <!-- END SIDEBAR USER TITLE -->
                <!-- SIDEBAR BUTTONS -->
                <div class="profile-userbuttons">
                <!--    <button type="button" class="btn btn-success btn-sm">Follow</button>
                    <button type="button" class="btn btn-primary-blue btn-sm">Message</button> -->
                </div>
                <!-- END SIDEBAR BUTTONS -->
                <!-- SIDEBAR MENU -->
                <div class="profile-usermenu">
                    <ul class="nav">
                      <!--  <li class="active">
                            <a href="#">
                            <i class="glyphicon glyphicon-home"></i>
                            Account </a>
                        </li> -->
                        <li>
                            <a href="/g/settings">
                        <!--    <i class="glyphicon glyphicon-user"></i> -->
                            Account Settings </a>
                        </li>
                        <li>
                            <a href="/g/account">
                          <!--  <i class="glyphicon glyphicon-ok"></i> --> 
                            Password </a>
                        </li>
                      <!--  <li>
                            <a href="#">
                            <i class="glyphicon glyphicon-flag"></i>
                            Help </a>
                        </li> -->
                    </ul>
                </div>
                <!-- END MENU -->
            </div>
        </div>
        <div class="col-md-9">
            <div class="profile-content">
                <div class="account-setting-form" data-gitlist-action="2">
                    <h2>Account Setting</h2>
                    <% if(username != "") { %>
                        <p>  Username </p> 
                        <input type="email" name="email" class="form-control username-input" placeholder="Username" id="gl-username-1" value="<%- username%>"><br><br>
                        <p>  Your Job</p>  
                        <input  class="form-control password-input" placeholder="Your Job" type="text" id="gl-job-1" value="<%- job%>"><br>
                        <p>  Website </p>  
                        <input class="form-control website-input" placeholder="https://" type="text" id="gl-website-1" value="<%- website%>"><br>
                        <p>  Your e-Mail</p> <input  class="form-control email-input" placeholder="Your e-Mail" type="text" id="gl-email-1" value="<%- email%>" disabled><br>                    
                        <button type="submit" class="accont-update-button btn btn-primary-blue btn-sm"  value="">Change</button>
                    <% }else {%>
                        <p>  Username </p> 
                        <input type="email" name="email" class="form-control username-input" placeholder="Username" id="gl-username-1" disabled><br><br>
                        <p>  Your Job</p>  
                        <input  class="form-control password-input" placeholder="Your Job" type="text" id="gl-job-1" disabled><br>
                        <p>  Website </p>  
                        <input class="form-control website-input" placeholder="https://" type="text" id="gl-website-1" disabled><br>
                        <p>  Your e-Mail</p> <input  class="form-control email-input" placeholder="Your e-Mail" type="text" id="gl-email-1" disabled><br>                    
                        <button type="submit" class="accont-update-button btn btn-primary-blue btn-sm"  value="" disabled>Change</button>
                    <% } %>
                </div>
            </div>
        </div>
    </div>
</div>
<footer class="footer">
    <div class="container">
        <ul class="footer-links-list-copyright">
            <li> 
                <%- partial ('../partials/gitlist-user-counter.ejs') %>  
            </li>
        </ul>
        <ul class="footer-links-list">
            <%- partial ('../partials/gitlist-social-footer.ejs') %>  
            <hr>
        </ul>
    </div>
    <hr/>
    <div class="inner-gitlist-copyright">
        <%- partial ('../partials/copyright.ejs') %>  
    </div>
</footer>

<script type="text/javascript">
  $.notify.addStyle('confirm', {
      html: "<div><span data-notify-text/><span>&nbsp;&nbsp;Please click <a href='/g/login'>here</a> to login!</span></div>",
  });

  //-- Check User logged in -- 
  $.post(
      '/login',
      {},
      function (res) {
          if(!res.user){
              $.notify("You must login or signup before set user profile!", {style: 'confirm', className: "success", autoHide: false, clickToHide: false});
          }
      }
  ).fail(function(res){
      $.notify("Error!", "error");
  });

  // Image Upload form Reset
  $('#multiform').each(function(){
      this.reset();
  });

  // Put a selected picture on Profile Image.
  function readURL(input) {
      if (input.files && input.files[0]) {
          var reader = new FileReader();            
          reader.onload = function (e) {
              $('#userpic').attr('src', e.target.result);
          }            
          reader.readAsDataURL(input.files[0]);
      }
  }

  $("#userimage").change(function(e){
      readURL(this);
      var files = e.target.files || e.dataTransfer.files;
  });

  $('#userpic').click(function (e) {
      e.preventDefault();
      $('#userimage').click();
  }); 
   
  // Profile Image Upload and Save it.
  $("#multiform").submit(function(e)
  {
      e.preventDefault(); //Prevent Default action. 

      var formObj = $(this);
      var formURL = formObj.attr("action");
      var formData = new FormData(this);
      $.ajax({
          url: formURL,
          type: 'POST',
          data:  formData,
          mimeType:"multipart/form-data",
          contentType: false,
          cache: false,
          processData:false,
          success: function(data, textStatus, jqXHR)
          {
              if(data){
                $.notify("User image saved successfully!", "success");
                var reader = new FileReader();            
                reader.onload = function (e) {
                    $('#userpic').attr('src',data);
                } 
//                window.location = "/g/settings";
              }
          },
          error: function(jqXHR, textStatus, errorThrown) 
          {
              console.log("Uploaded Error!");
          }                          
      });      
  }); 
  $("#multiform").submit(); 
  
  $(".accont-update-button").click(function(){
      var email = $('#gl-email-1').val();
      $('#gl-email-1').prop('disabled', true);
      var username = $('#gl-username-1').val();
      var job = $('#gl-job-1').val();
      var website = $('#gl-website-1').val();

      if(email && username && job && website){
          $.post(
            '/updateUser',
            {email: email, username: username, job: job, website: website},
            function(res){
                $.notify("User setting Updated!", "success");
                window.location = "/g/settings";
            }
          ).fail(function(res){
              $.notify("Error!", "error");
          });       
      }else{
          $.notify("Please input account info!", "error");
      }
  });
</script>
<style>
    .notifyjs-confirm-base {
        font-weight: bold;
        padding: 8px 15px 8px 14px;
        text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
        background-color: #fcf8e3;
        border: 1px solid #fbeed5;
        border-radius: 4px;
        white-space: nowrap;
        padding-left: 25px;
        background-repeat: no-repeat;
        background-position: 3px 7px;
    }
    .notifyjs-confirm-success {
        color: #468847;
        background-color: #DFF0D8;
        border-color: #D6E9C6;
        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAutJREFUeNq0lctPE0Ecx38zu/RFS1EryqtgJFA08YCiMZIAQQ4eRG8eDGdPJiYeTIwHTfwPiAcvXIwXLwoXPaDxkWgQ6islKlJLSQWLUraPLTv7Gme32zoF9KSTfLO7v53vZ3d/M7/fIth+IO6INt2jjoA7bjHCJoAlzCRw59YwHYjBnfMPqAKWQYKjGkfCJqAF0xwZjipQtA3MxeSG87VhOOYegVrUCy7UZM9S6TLIdAamySTclZdYhFhRHloGYg7mgZv1Zzztvgud7V1tbQ2twYA34LJmF4p5dXF1KTufnE+SxeJtuCZNsLDCQU0+RyKTF27Unw101l8e6hns3u0PBalORVVVkcaEKBJDgV3+cGM4tKKmI+ohlIGnygKX00rSBfszz/n2uXv81wd6+rt1orsZCHRdr1Imk2F2Kob3hutSxW8thsd8AXNaln9D7CTfA6O+0UgkMuwVvEFFUbbAcrkcTA8+AtOk8E6KiQiDmMFSDqZItAzEVQviRkdDdaFgPp8HSZKAEAL5Qh7Sq2lIJBJwv2scUqkUnKoZgNhcDKhKg5aH+1IkcouCAdFGAQsuWZYhOjwFHQ96oagWgRoUov1T9kRBEODAwxM2QtEUl+Wp+Ln9VRo6BcMw4ErHRYjH4/B26AlQoQQTRdHWwcd9AH57+UAXddvDD37DmrBBV34WfqiXPl61g+vr6xA9zsGeM9gOdsNXkgpEtTwVvwOklXLKm6+/p5ezwk4B+j6droBs2CsGa/gNs6RIxazl4Tc25mpTgw/apPR1LYlNRFAzgsOxkyXYLIM1V8NMwyAkJSctD1eGVKiq5wWjSPdjmeTkiKvVW4f2YPHWl3GAVq6ymcyCTgovM3FzyRiDe2TaKcEKsLpJvNHjZgPNqEtyi6mZIm4SRFyLMUsONSSdkPeFtY1n0mczoY3BHTLhwPRy9/lzcziCw9ACI+yql0VLzcGAZbYSM5CCSZg1/9oc/nn7+i8N9p/8An4JMADxhH+xHfuiKwAAAABJRU5ErkJggg==);
    }
</style>